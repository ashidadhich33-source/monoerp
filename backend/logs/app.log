2025-09-28 09:36:52,189 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 09:36:52,189 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-28 09:36:52,189 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,190 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("staff")
2025-09-28 09:36:52,191 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,191 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-28 09:36:52,191 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,191 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("attendance")
2025-09-28 09:36:52,191 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,191 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-28 09:36:52,191 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,192 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("sales")
2025-09-28 09:36:52,192 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,192 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-28 09:36:52,192 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,192 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("brands")
2025-09-28 09:36:52,192 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,192 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-28 09:36:52,192 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,192 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("targets")
2025-09-28 09:36:52,193 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,193 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-28 09:36:52,193 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,193 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("achievements")
2025-09-28 09:36:52,193 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,193 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-28 09:36:52,193 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,193 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("salary")
2025-09-28 09:36:52,193 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,194 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-28 09:36:52,194 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,194 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("advances")
2025-09-28 09:36:52,194 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,194 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-28 09:36:52,194 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,194 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("rankings")
2025-09-28 09:36:52,194 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,194 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-28 09:36:52,194 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,195 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("notifications")
2025-09-28 09:36:52,195 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,195 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-28 09:36:52,195 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,195 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("audit_logs")
2025-09-28 09:36:52,195 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,195 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-28 09:36:52,195 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,195 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("performance_metrics")
2025-09-28 09:36:52,195 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:36:52,197 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE staff (
	id INTEGER NOT NULL, 
	employee_code VARCHAR(50) NOT NULL, 
	name VARCHAR(100) NOT NULL, 
	email VARCHAR(100) NOT NULL, 
	password_hash VARCHAR(255) NOT NULL, 
	phone VARCHAR(20), 
	basic_salary FLOAT NOT NULL, 
	incentive_percentage FLOAT NOT NULL, 
	department VARCHAR(100), 
	joining_date DATE NOT NULL, 
	is_active BOOLEAN, 
	is_admin BOOLEAN, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	PRIMARY KEY (id)
)


2025-09-28 09:36:52,197 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2025-09-28 09:36:52,211 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_staff_email ON staff (email)
2025-09-28 09:36:52,212 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2025-09-28 09:36:52,230 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_staff_id ON staff (id)
2025-09-28 09:36:52,230 - sqlalchemy.engine.Engine - INFO - [no key 0.00035s] ()
2025-09-28 09:36:52,237 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_staff_employee_code ON staff (employee_code)
2025-09-28 09:36:52,237 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2025-09-28 09:36:52,247 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE brands (
	id INTEGER NOT NULL, 
	brand_name VARCHAR(100) NOT NULL, 
	brand_code VARCHAR(50) NOT NULL, 
	description VARCHAR(500), 
	category VARCHAR(100), 
	is_active BOOLEAN, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	PRIMARY KEY (id)
)


2025-09-28 09:36:52,247 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2025-09-28 09:36:52,251 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_brands_brand_code ON brands (brand_code)
2025-09-28 09:36:52,251 - sqlalchemy.engine.Engine - INFO - [no key 0.00021s] ()
2025-09-28 09:36:52,266 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_brands_id ON brands (id)
2025-09-28 09:36:52,266 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2025-09-28 09:36:52,271 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE audit_logs (
	id INTEGER NOT NULL, 
	user_id INTEGER, 
	action VARCHAR(100) NOT NULL, 
	resource_type VARCHAR(50) NOT NULL, 
	resource_id INTEGER, 
	details JSON, 
	ip_address VARCHAR(45), 
	user_agent TEXT, 
	severity VARCHAR(20) NOT NULL, 
	timestamp DATETIME NOT NULL, 
	PRIMARY KEY (id)
)


2025-09-28 09:36:52,271 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2025-09-28 09:36:52,278 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_audit_logs_user_id ON audit_logs (user_id)
2025-09-28 09:36:52,278 - sqlalchemy.engine.Engine - INFO - [no key 0.00021s] ()
2025-09-28 09:36:52,280 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_audit_logs_timestamp ON audit_logs (timestamp)
2025-09-28 09:36:52,280 - sqlalchemy.engine.Engine - INFO - [no key 0.00021s] ()
2025-09-28 09:36:52,285 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_audit_logs_action ON audit_logs (action)
2025-09-28 09:36:52,286 - sqlalchemy.engine.Engine - INFO - [no key 0.00016s] ()
2025-09-28 09:36:52,293 - sqlalchemy.engine.Engine - INFO - CREATE INDEX idx_user_timestamp ON audit_logs (user_id, timestamp)
2025-09-28 09:36:52,293 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2025-09-28 09:36:52,299 - sqlalchemy.engine.Engine - INFO - CREATE INDEX idx_action_timestamp ON audit_logs (action, timestamp)
2025-09-28 09:36:52,300 - sqlalchemy.engine.Engine - INFO - [no key 0.00019s] ()
2025-09-28 09:36:52,303 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_audit_logs_resource_id ON audit_logs (resource_id)
2025-09-28 09:36:52,303 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2025-09-28 09:36:52,308 - sqlalchemy.engine.Engine - INFO - CREATE INDEX idx_resource_timestamp ON audit_logs (resource_type, timestamp)
2025-09-28 09:36:52,308 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2025-09-28 09:36:52,321 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_audit_logs_id ON audit_logs (id)
2025-09-28 09:36:52,322 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2025-09-28 09:36:52,324 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_audit_logs_resource_type ON audit_logs (resource_type)
2025-09-28 09:36:52,324 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2025-09-28 09:36:52,329 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE performance_metrics (
	id INTEGER NOT NULL, 
	metric_type VARCHAR(50) NOT NULL, 
	value FLOAT NOT NULL, 
	details JSON, 
	timestamp DATETIME NOT NULL, 
	PRIMARY KEY (id)
)


2025-09-28 09:36:52,329 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2025-09-28 09:36:52,332 - sqlalchemy.engine.Engine - INFO - CREATE INDEX idx_timestamp_metric ON performance_metrics (timestamp, metric_type)
2025-09-28 09:36:52,332 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2025-09-28 09:36:52,336 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_performance_metrics_id ON performance_metrics (id)
2025-09-28 09:36:52,337 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2025-09-28 09:36:52,345 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_performance_metrics_timestamp ON performance_metrics (timestamp)
2025-09-28 09:36:52,346 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2025-09-28 09:36:52,352 - sqlalchemy.engine.Engine - INFO - CREATE INDEX idx_metric_timestamp ON performance_metrics (metric_type, timestamp)
2025-09-28 09:36:52,352 - sqlalchemy.engine.Engine - INFO - [no key 0.00021s] ()
2025-09-28 09:36:52,358 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_performance_metrics_metric_type ON performance_metrics (metric_type)
2025-09-28 09:36:52,359 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2025-09-28 09:36:52,363 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE attendance (
	id INTEGER NOT NULL, 
	staff_id INTEGER NOT NULL, 
	check_in_time DATETIME, 
	check_out_time DATETIME, 
	date DATE NOT NULL, 
	wifi_mac_address VARCHAR(17), 
	ip_address VARCHAR(45), 
	device_fingerprint VARCHAR(255), 
	status VARCHAR(8), 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(staff_id) REFERENCES staff (id)
)


2025-09-28 09:36:52,363 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2025-09-28 09:36:52,377 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_attendance_id ON attendance (id)
2025-09-28 09:36:52,377 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2025-09-28 09:36:52,391 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE sales (
	id INTEGER NOT NULL, 
	staff_id INTEGER NOT NULL, 
	brand_id INTEGER NOT NULL, 
	sale_amount FLOAT NOT NULL, 
	sale_date DATE NOT NULL, 
	units_sold INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(staff_id) REFERENCES staff (id), 
	FOREIGN KEY(brand_id) REFERENCES brands (id)
)


2025-09-28 09:36:52,391 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2025-09-28 09:36:52,397 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_sales_id ON sales (id)
2025-09-28 09:36:52,397 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2025-09-28 09:36:52,406 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE targets (
	id INTEGER NOT NULL, 
	staff_id INTEGER NOT NULL, 
	target_type VARCHAR(9) NOT NULL, 
	total_target_amount FLOAT NOT NULL, 
	brand_wise_targets JSON, 
	period_start DATE NOT NULL, 
	period_end DATE NOT NULL, 
	incentive_percentage FLOAT NOT NULL, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(staff_id) REFERENCES staff (id)
)


2025-09-28 09:36:52,406 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2025-09-28 09:36:52,409 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_targets_id ON targets (id)
2025-09-28 09:36:52,409 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2025-09-28 09:36:52,428 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE salary (
	id INTEGER NOT NULL, 
	staff_id INTEGER NOT NULL, 
	month_year VARCHAR(7) NOT NULL, 
	basic_salary FLOAT NOT NULL, 
	working_days INTEGER NOT NULL, 
	present_days INTEGER NOT NULL, 
	sunday_count INTEGER NOT NULL, 
	salary_for_days FLOAT NOT NULL, 
	target_incentive FLOAT NOT NULL, 
	basic_incentive FLOAT NOT NULL, 
	gross_salary FLOAT NOT NULL, 
	advance_deduction FLOAT NOT NULL, 
	net_salary FLOAT NOT NULL, 
	payment_status VARCHAR(8), 
	payment_date DATE, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(staff_id) REFERENCES staff (id)
)


2025-09-28 09:36:52,428 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2025-09-28 09:36:52,441 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_salary_id ON salary (id)
2025-09-28 09:36:52,441 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2025-09-28 09:36:52,450 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE advances (
	id INTEGER NOT NULL, 
	staff_id INTEGER NOT NULL, 
	advance_amount FLOAT NOT NULL, 
	reason TEXT, 
	issue_date DATE NOT NULL, 
	total_deducted FLOAT NOT NULL, 
	remaining_amount FLOAT NOT NULL, 
	deduction_plan VARCHAR(7) NOT NULL, 
	monthly_deduction_amount FLOAT, 
	status VARCHAR(7), 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(staff_id) REFERENCES staff (id)
)


2025-09-28 09:36:52,457 - sqlalchemy.engine.Engine - INFO - [no key 0.00751s] ()
2025-09-28 09:36:52,461 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_advances_id ON advances (id)
2025-09-28 09:36:52,461 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2025-09-28 09:36:52,467 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE rankings (
	id INTEGER NOT NULL, 
	staff_id INTEGER NOT NULL, 
	period_type VARCHAR(9) NOT NULL, 
	period_date DATE NOT NULL, 
	total_sales FLOAT NOT NULL, 
	rank_position INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(staff_id) REFERENCES staff (id)
)


2025-09-28 09:36:52,468 - sqlalchemy.engine.Engine - INFO - [no key 0.00069s] ()
2025-09-28 09:36:52,482 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_rankings_id ON rankings (id)
2025-09-28 09:36:52,482 - sqlalchemy.engine.Engine - INFO - [no key 0.00037s] ()
2025-09-28 09:36:52,485 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE notifications (
	id INTEGER NOT NULL, 
	staff_id INTEGER NOT NULL, 
	title VARCHAR(255) NOT NULL, 
	message TEXT NOT NULL, 
	notification_type VARCHAR(50) NOT NULL, 
	priority VARCHAR(20) NOT NULL, 
	data JSON, 
	is_read BOOLEAN NOT NULL, 
	read_at DATETIME, 
	created_at DATETIME NOT NULL, 
	updated_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(staff_id) REFERENCES staff (id)
)


2025-09-28 09:36:52,485 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2025-09-28 09:36:52,487 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_notifications_staff_id ON notifications (staff_id)
2025-09-28 09:36:52,487 - sqlalchemy.engine.Engine - INFO - [no key 0.00016s] ()
2025-09-28 09:36:52,501 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_notifications_id ON notifications (id)
2025-09-28 09:36:52,501 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2025-09-28 09:36:52,511 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE achievements (
	id INTEGER NOT NULL, 
	staff_id INTEGER NOT NULL, 
	target_id INTEGER NOT NULL, 
	achieved_amount FLOAT NOT NULL, 
	achievement_percentage FLOAT NOT NULL, 
	incentive_earned FLOAT NOT NULL, 
	period VARCHAR(20) NOT NULL, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(staff_id) REFERENCES staff (id), 
	FOREIGN KEY(target_id) REFERENCES targets (id)
)


2025-09-28 09:36:52,511 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2025-09-28 09:36:52,515 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_achievements_id ON achievements (id)
2025-09-28 09:36:52,515 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2025-09-28 09:36:52,522 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 09:36:52,523 - main - INFO - Database tables created successfully
2025-09-28 09:39:47,217 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 09:39:47,218 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-28 09:39:47,218 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:47,219 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-28 09:39:47,220 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:47,220 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-28 09:39:47,220 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:47,220 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-28 09:39:47,220 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:47,220 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-28 09:39:47,221 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:47,221 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-28 09:39:47,221 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:47,221 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-28 09:39:47,221 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:47,221 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-28 09:39:47,221 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:47,221 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-28 09:39:47,221 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:47,222 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-28 09:39:47,222 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:47,222 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-28 09:39:47,222 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:47,222 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-28 09:39:47,222 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:47,223 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 09:39:47,223 - __main__ - INFO - Database tables created successfully
2025-09-28 09:39:47,326 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-28 09:39:47,327 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-28 09:39:47,331 - app.services.scheduler_service - INFO - Scheduler started
2025-09-28 09:39:47,331 - app.services.scheduler_service - INFO - All background tasks started
2025-09-28 09:39:47,331 - __main__ - INFO - Application started with background tasks
2025-09-28 09:39:52,006 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 09:39:52,007 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-28 09:39:52,007 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:52,009 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-28 09:39:52,009 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:52,009 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-28 09:39:52,009 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:52,010 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-28 09:39:52,010 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:52,010 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-28 09:39:52,010 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:52,011 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-28 09:39:52,011 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:52,011 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-28 09:39:52,011 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:52,011 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-28 09:39:52,011 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:52,012 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-28 09:39:52,012 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:52,012 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-28 09:39:52,012 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:52,012 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-28 09:39:52,012 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:52,012 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-28 09:39:52,012 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:52,014 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 09:39:52,014 - main - INFO - Database tables created successfully
2025-09-28 09:39:52,052 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-28 09:39:52,053 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-28 09:39:52,057 - app.services.scheduler_service - INFO - Scheduler started
2025-09-28 09:39:52,057 - app.services.scheduler_service - INFO - All background tasks started
2025-09-28 09:39:52,057 - main - INFO - Application started with background tasks
2025-09-28 09:39:56,244 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 09:39:56,245 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-28 09:39:56,245 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:56,246 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-28 09:39:56,246 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:56,246 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-28 09:39:56,246 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:56,246 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-28 09:39:56,247 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:56,247 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-28 09:39:56,247 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:56,247 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-28 09:39:56,247 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:56,247 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-28 09:39:56,247 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:56,248 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-28 09:39:56,248 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:56,248 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-28 09:39:56,248 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:56,248 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-28 09:39:56,248 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:56,248 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-28 09:39:56,248 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:56,248 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-28 09:39:56,249 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:39:56,250 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 09:39:56,250 - main - INFO - Database tables created successfully
2025-09-28 09:39:56,280 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-28 09:39:56,281 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-28 09:39:56,285 - app.services.scheduler_service - INFO - Scheduler started
2025-09-28 09:39:56,285 - app.services.scheduler_service - INFO - All background tasks started
2025-09-28 09:39:56,285 - main - INFO - Application started with background tasks
2025-09-28 09:40:52,054 - app.services.scheduler_service - INFO - Scheduler stopped
2025-09-28 09:40:52,054 - app.services.scheduler_service - INFO - All background tasks stopped
2025-09-28 09:40:52,055 - main - INFO - Application shutdown with background tasks stopped
2025-09-28 09:40:56,281 - app.services.scheduler_service - INFO - Scheduler stopped
2025-09-28 09:40:56,282 - app.services.scheduler_service - INFO - All background tasks stopped
2025-09-28 09:40:56,287 - main - INFO - Application shutdown with background tasks stopped
2025-09-28 09:41:02,325 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 09:41:02,325 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-28 09:41:02,325 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:02,327 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-28 09:41:02,327 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:02,327 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-28 09:41:02,327 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:02,327 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-28 09:41:02,327 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:02,327 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-28 09:41:02,327 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:02,331 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-28 09:41:02,331 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:02,331 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-28 09:41:02,331 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:02,331 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-28 09:41:02,331 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:02,332 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-28 09:41:02,332 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:02,332 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-28 09:41:02,332 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:02,332 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-28 09:41:02,332 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:02,332 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-28 09:41:02,332 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:02,333 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 09:41:02,333 - main - INFO - Database tables created successfully
2025-09-28 09:41:02,549 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-28 09:41:02,549 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-28 09:41:02,551 - app.services.scheduler_service - INFO - Scheduler started
2025-09-28 09:41:02,551 - app.services.scheduler_service - INFO - All background tasks started
2025-09-28 09:41:02,551 - main - INFO - Application started with background tasks
2025-09-28 09:41:09,219 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 09:41:09,219 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-28 09:41:09,219 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:09,220 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-28 09:41:09,221 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:09,221 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-28 09:41:09,221 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:09,221 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-28 09:41:09,221 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:09,221 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-28 09:41:09,221 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:09,222 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-28 09:41:09,222 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:09,222 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-28 09:41:09,222 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:09,222 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-28 09:41:09,222 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:09,222 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-28 09:41:09,222 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:09,223 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-28 09:41:09,223 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:09,223 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-28 09:41:09,223 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:09,223 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-28 09:41:09,223 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:41:09,224 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 09:41:09,224 - main - INFO - Database tables created successfully
2025-09-28 09:41:09,321 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-28 09:41:09,322 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-28 09:41:09,322 - app.services.scheduler_service - INFO - Scheduler started
2025-09-28 09:41:09,322 - app.services.scheduler_service - INFO - All background tasks started
2025-09-28 09:41:09,322 - main - INFO - Application started with background tasks
2025-09-28 09:42:02,552 - app.services.scheduler_service - INFO - Scheduler stopped
2025-09-28 09:42:02,553 - app.services.scheduler_service - INFO - All background tasks stopped
2025-09-28 09:42:02,553 - main - INFO - Application shutdown with background tasks stopped
2025-09-28 09:42:05,896 - app.models.base - ERROR - Database connection error: Textual SQL expression 'SELECT 1' should be explicitly declared as text('SELECT 1')
2025-09-28 09:42:05,925 - app.utils.error_handler - ERROR - Application Error: {
  "timestamp": "2025-09-28T09:42:05.900558",
  "error_type": "ArgumentError",
  "error_message": "Textual SQL expression 'SELECT 1' should be explicitly declared as text('SELECT 1')",
  "user_id": null,
  "request_url": null,
  "request_method": null,
  "client_ip": null,
  "traceback": "Traceback (most recent call last):\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/base.py\", line 182, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/usr/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/base.py\", line 184, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/workspace/backend/app/middleware/security.py\", line 131, in security_middleware_handler\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/base.py\", line 159, in call_next\n    raise app_exc\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/fastapi/routing.py\", line 298, in app\n    solved_result = await solve_dependencies(\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/fastapi/dependencies/utils.py\", line 642, in solve_dependencies\n    solved = await solve_generator(\n             ^^^^^^^^^^^^^^^^^^^^^^\n        call=call, stack=async_exit_stack, sub_values=solved_result.values\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/fastapi/dependencies/utils.py\", line 568, in solve_generator\n    return await stack.enter_async_context(cm)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.13/contextlib.py\", line 668, in enter_async_context\n    result = await _enter(cm)\n             ^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.13/contextlib.py\", line 214, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/fastapi/concurrency.py\", line 35, in contextmanager_in_threadpool\n    raise e\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/fastapi/concurrency.py\", line 27, in contextmanager_in_threadpool\n    yield await run_in_threadpool(cm.__enter__)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/concurrency.py\", line 38, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 2485, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 976, in run\n    result = context.run(func, *args)\n  File \"/usr/lib/python3.13/contextlib.py\", line 141, in __enter__\n    return next(self.gen)\n  File \"/workspace/backend/app/models/base.py\", line 36, in get_db\n    db.execute(\"SELECT 1\")\n    ~~~~~~~~~~^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/sqlalchemy/orm/session.py\", line 2365, in execute\n    return self._execute_internal(\n           ~~~~~~~~~~~~~~~~~~~~~~^\n        statement,\n        ^^^^^^^^^^\n    ...<4 lines>...\n        _add_event=_add_event,\n        ^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/sqlalchemy/orm/session.py\", line 2149, in _execute_internal\n    statement = coercions.expect(roles.StatementRole, statement)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/sqlalchemy/sql/coercions.py\", line 395, in expect\n    resolved = impl._literal_coercion(\n        element, argname=argname, **kw\n    )\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/sqlalchemy/sql/coercions.py\", line 621, in _literal_coercion\n    return self._text_coercion(element, argname, **kw)\n           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/sqlalchemy/sql/coercions.py\", line 614, in _text_coercion\n    return _no_text_coercion(element, argname)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/sqlalchemy/sql/coercions.py\", line 584, in _no_text_coercion\n    raise exc_cls(\n    ...<7 lines>...\n    ) from err\nsqlalchemy.exc.ArgumentError: Textual SQL expression 'SELECT 1' should be explicitly declared as text('SELECT 1')\n"
}
2025-09-28 09:42:08,049 - app.models.base - ERROR - Database connection error: Textual SQL expression 'SELECT 1' should be explicitly declared as text('SELECT 1')
2025-09-28 09:42:08,059 - app.utils.error_handler - ERROR - Application Error: {
  "timestamp": "2025-09-28T09:42:08.050865",
  "error_type": "ArgumentError",
  "error_message": "Textual SQL expression 'SELECT 1' should be explicitly declared as text('SELECT 1')",
  "user_id": null,
  "request_url": null,
  "request_method": null,
  "client_ip": null,
  "traceback": "Traceback (most recent call last):\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/base.py\", line 182, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/usr/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/base.py\", line 184, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/workspace/backend/app/middleware/security.py\", line 131, in security_middleware_handler\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/base.py\", line 159, in call_next\n    raise app_exc\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/fastapi/routing.py\", line 298, in app\n    solved_result = await solve_dependencies(\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/fastapi/dependencies/utils.py\", line 642, in solve_dependencies\n    solved = await solve_generator(\n             ^^^^^^^^^^^^^^^^^^^^^^\n        call=call, stack=async_exit_stack, sub_values=solved_result.values\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/fastapi/dependencies/utils.py\", line 568, in solve_generator\n    return await stack.enter_async_context(cm)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.13/contextlib.py\", line 668, in enter_async_context\n    result = await _enter(cm)\n             ^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.13/contextlib.py\", line 214, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/fastapi/concurrency.py\", line 35, in contextmanager_in_threadpool\n    raise e\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/fastapi/concurrency.py\", line 27, in contextmanager_in_threadpool\n    yield await run_in_threadpool(cm.__enter__)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/concurrency.py\", line 38, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 2485, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 976, in run\n    result = context.run(func, *args)\n  File \"/usr/lib/python3.13/contextlib.py\", line 141, in __enter__\n    return next(self.gen)\n  File \"/workspace/backend/app/models/base.py\", line 36, in get_db\n    db.execute(\"SELECT 1\")\n    ~~~~~~~~~~^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/sqlalchemy/orm/session.py\", line 2365, in execute\n    return self._execute_internal(\n           ~~~~~~~~~~~~~~~~~~~~~~^\n        statement,\n        ^^^^^^^^^^\n    ...<4 lines>...\n        _add_event=_add_event,\n        ^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/sqlalchemy/orm/session.py\", line 2149, in _execute_internal\n    statement = coercions.expect(roles.StatementRole, statement)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/sqlalchemy/sql/coercions.py\", line 395, in expect\n    resolved = impl._literal_coercion(\n        element, argname=argname, **kw\n    )\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/sqlalchemy/sql/coercions.py\", line 621, in _literal_coercion\n    return self._text_coercion(element, argname, **kw)\n           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/sqlalchemy/sql/coercions.py\", line 614, in _text_coercion\n    return _no_text_coercion(element, argname)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/sqlalchemy/sql/coercions.py\", line 584, in _no_text_coercion\n    raise exc_cls(\n    ...<7 lines>...\n    ) from err\nsqlalchemy.exc.ArgumentError: Textual SQL expression 'SELECT 1' should be explicitly declared as text('SELECT 1')\n"
}
2025-09-28 09:42:09,323 - app.services.scheduler_service - INFO - Scheduler stopped
2025-09-28 09:42:09,323 - app.services.scheduler_service - INFO - All background tasks stopped
2025-09-28 09:42:09,324 - main - INFO - Application shutdown with background tasks stopped
2025-09-28 09:42:28,322 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 09:42:28,322 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-28 09:42:28,322 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:42:28,323 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-28 09:42:28,323 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:42:28,324 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-28 09:42:28,324 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:42:28,324 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-28 09:42:28,324 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:42:28,324 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-28 09:42:28,324 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:42:28,324 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-28 09:42:28,325 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:42:28,325 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-28 09:42:28,325 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:42:28,325 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-28 09:42:28,325 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:42:28,325 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-28 09:42:28,325 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:42:28,325 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-28 09:42:28,325 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:42:28,326 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-28 09:42:28,326 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:42:28,326 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-28 09:42:28,326 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 09:42:28,327 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 09:42:28,327 - main - INFO - Database tables created successfully
2025-09-28 09:42:28,434 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-28 09:42:28,435 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-28 09:42:28,439 - app.services.scheduler_service - INFO - Scheduler started
2025-09-28 09:42:28,439 - app.services.scheduler_service - INFO - All background tasks started
2025-09-28 09:42:28,439 - main - INFO - Application started with background tasks
2025-09-28 09:42:31,580 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 09:42:31,581 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 09:42:31,581 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] ()
2025-09-28 09:42:31,586 - app.models.base - ERROR - Unexpected database error: 403: Access denied: Not on local network
2025-09-28 09:42:31,586 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 09:42:47,331 - app.services.scheduler_service - INFO - Scheduler stopped
2025-09-28 09:42:47,331 - app.services.scheduler_service - INFO - All background tasks stopped
2025-09-28 09:42:47,332 - __main__ - INFO - Application shutdown with background tasks stopped
2025-09-28 10:34:12,769 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 10:34:12,770 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-28 10:34:12,770 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 10:34:12,771 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-28 10:34:12,771 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 10:34:12,771 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-28 10:34:12,772 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 10:34:12,772 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-28 10:34:12,772 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 10:34:12,772 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-28 10:34:12,772 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 10:34:12,772 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-28 10:34:12,772 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 10:34:12,772 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-28 10:34:12,772 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 10:34:12,773 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-28 10:34:12,773 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 10:34:12,773 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-28 10:34:12,773 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 10:34:12,773 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-28 10:34:12,773 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 10:34:12,773 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-28 10:34:12,773 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 10:34:12,774 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-28 10:34:12,774 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 10:34:12,774 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("companies")
2025-09-28 10:34:12,774 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 10:34:12,774 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("companies")
2025-09-28 10:34:12,774 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 10:34:12,774 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("setup_states")
2025-09-28 10:34:12,774 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 10:34:12,774 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("setup_states")
2025-09-28 10:34:12,774 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 10:34:12,776 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE companies (
	id INTEGER NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	address TEXT, 
	phone VARCHAR(50), 
	industry_type VARCHAR(100), 
	timezone VARCHAR(50), 
	currency VARCHAR(10), 
	working_hours_start VARCHAR(10), 
	working_hours_end VARCHAR(10), 
	is_setup_complete BOOLEAN, 
	setup_completed_at DATETIME, 
	created_at DATETIME DEFAULT CURRENT_TIMESTAMP, 
	updated_at DATETIME, 
	PRIMARY KEY (id)
)


2025-09-28 10:34:12,776 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2025-09-28 10:34:12,782 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_companies_id ON companies (id)
2025-09-28 10:34:12,782 - sqlalchemy.engine.Engine - INFO - [no key 0.00021s] ()
2025-09-28 10:34:12,788 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_companies_name ON companies (name)
2025-09-28 10:34:12,788 - sqlalchemy.engine.Engine - INFO - [no key 0.00017s] ()
2025-09-28 10:34:12,790 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE setup_states (
	id INTEGER NOT NULL, 
	company_created BOOLEAN, 
	admin_created BOOLEAN, 
	database_initialized BOOLEAN, 
	system_configured BOOLEAN, 
	setup_data TEXT, 
	last_error TEXT, 
	error_count INTEGER, 
	started_at DATETIME DEFAULT CURRENT_TIMESTAMP, 
	completed_at DATETIME, 
	updated_at DATETIME, 
	PRIMARY KEY (id)
)


2025-09-28 10:34:12,791 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2025-09-28 10:34:12,800 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_setup_states_id ON setup_states (id)
2025-09-28 10:34:12,800 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2025-09-28 10:34:12,803 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 10:34:12,803 - main - INFO - Database tables created successfully
2025-09-28 11:11:18,981 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:11:18,981 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-28 11:11:18,982 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:18,983 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-28 11:11:18,984 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:18,984 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-28 11:11:18,985 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:18,985 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-28 11:11:18,985 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:18,986 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-28 11:11:18,986 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:18,986 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-28 11:11:18,986 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:18,986 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-28 11:11:18,986 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:18,988 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-28 11:11:18,988 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:18,988 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-28 11:11:18,988 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:18,988 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-28 11:11:18,988 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:18,988 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-28 11:11:18,988 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:18,989 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-28 11:11:18,989 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:18,989 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("companies")
2025-09-28 11:11:18,989 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:18,989 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("setup_states")
2025-09-28 11:11:18,989 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:18,990 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:11:18,990 - __main__ - INFO - Database tables created successfully
2025-09-28 11:11:19,088 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-28 11:11:19,089 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-28 11:11:19,089 - app.services.scheduler_service - INFO - Scheduler started
2025-09-28 11:11:19,089 - app.services.scheduler_service - INFO - All background tasks started
2025-09-28 11:11:19,090 - __main__ - INFO - Application started with background tasks
2025-09-28 11:11:48,433 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:11:48,433 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-28 11:11:48,433 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:48,434 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-28 11:11:48,435 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:48,435 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-28 11:11:48,435 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:48,435 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-28 11:11:48,435 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:48,435 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-28 11:11:48,435 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:48,436 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-28 11:11:48,436 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:48,436 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-28 11:11:48,436 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:48,436 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-28 11:11:48,436 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:48,436 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-28 11:11:48,436 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:48,436 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-28 11:11:48,437 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:48,437 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-28 11:11:48,437 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:48,437 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-28 11:11:48,437 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:48,437 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("companies")
2025-09-28 11:11:48,437 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:48,438 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("setup_states")
2025-09-28 11:11:48,438 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:11:48,438 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:11:48,438 - __main__ - INFO - Database tables created successfully
2025-09-28 11:11:48,535 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-28 11:11:48,539 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-28 11:11:48,542 - app.services.scheduler_service - INFO - Scheduler started
2025-09-28 11:11:48,543 - app.services.scheduler_service - INFO - All background tasks started
2025-09-28 11:11:48,543 - __main__ - INFO - Application started with background tasks
2025-09-28 11:11:51,403 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:11:51,404 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:11:51,404 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ()
2025-09-28 11:11:51,480 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies
 LIMIT ? OFFSET ?
2025-09-28 11:11:51,480 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] (1, 0)
2025-09-28 11:11:51,483 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:12:19,090 - app.services.scheduler_service - INFO - Scheduler stopped
2025-09-28 11:12:19,091 - app.services.scheduler_service - INFO - All background tasks stopped
2025-09-28 11:12:19,092 - __main__ - INFO - Application shutdown with background tasks stopped
2025-09-28 11:12:40,962 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:12:40,963 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-28 11:12:40,963 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:12:40,964 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-28 11:12:40,964 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:12:40,965 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-28 11:12:40,965 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:12:40,965 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-28 11:12:40,965 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:12:40,965 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-28 11:12:40,965 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:12:40,965 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-28 11:12:40,965 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:12:40,966 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-28 11:12:40,966 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:12:40,966 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-28 11:12:40,966 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:12:40,967 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-28 11:12:40,967 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:12:40,967 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-28 11:12:40,967 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:12:40,967 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-28 11:12:40,967 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:12:40,967 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-28 11:12:40,967 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:12:40,968 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("companies")
2025-09-28 11:12:40,968 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:12:40,968 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("setup_states")
2025-09-28 11:12:40,968 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:12:40,969 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:12:40,969 - __main__ - INFO - Database tables created successfully
2025-09-28 11:12:41,082 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-28 11:12:41,083 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-28 11:12:41,087 - app.services.scheduler_service - INFO - Scheduler started
2025-09-28 11:12:41,087 - app.services.scheduler_service - INFO - All background tasks started
2025-09-28 11:12:41,087 - __main__ - INFO - Application started with background tasks
2025-09-28 11:12:46,987 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:12:46,988 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:12:46,988 - sqlalchemy.engine.Engine - INFO - [cached since 55.58s ago] ()
2025-09-28 11:12:46,997 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies
 LIMIT ? OFFSET ?
2025-09-28 11:12:46,997 - sqlalchemy.engine.Engine - INFO - [cached since 55.52s ago] (1, 0)
2025-09-28 11:12:46,999 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:12:51,894 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:12:51,894 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:12:51,894 - sqlalchemy.engine.Engine - INFO - [cached since 60.49s ago] ()
2025-09-28 11:12:51,896 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies
 LIMIT ? OFFSET ?
2025-09-28 11:12:51,896 - sqlalchemy.engine.Engine - INFO - [cached since 60.42s ago] (1, 0)
2025-09-28 11:12:51,906 - sqlalchemy.engine.Engine - INFO - INSERT INTO companies (name, address, phone, industry_type, timezone, currency, working_hours_start, working_hours_end, is_setup_complete, setup_completed_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id, created_at
2025-09-28 11:12:51,907 - sqlalchemy.engine.Engine - INFO - [generated in 0.00068s] ('Test Company', '123 Test Street', '+1234567890', 'Technology', 'UTC', 'USD', '09:00', '17:00', 0, None, None)
2025-09-28 11:12:51,909 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:12:51,934 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:12:51,943 - sqlalchemy.engine.Engine - INFO - SELECT companies.id, companies.name, companies.address, companies.phone, companies.industry_type, companies.timezone, companies.currency, companies.working_hours_start, companies.working_hours_end, companies.is_setup_complete, companies.setup_completed_at, companies.created_at, companies.updated_at 
FROM companies 
WHERE companies.id = ?
2025-09-28 11:12:51,943 - sqlalchemy.engine.Engine - INFO - [generated in 0.00497s] (1,)
2025-09-28 11:12:51,951 - sqlalchemy.engine.Engine - INFO - SELECT setup_states.id AS setup_states_id, setup_states.company_created AS setup_states_company_created, setup_states.admin_created AS setup_states_admin_created, setup_states.database_initialized AS setup_states_database_initialized, setup_states.system_configured AS setup_states_system_configured, setup_states.setup_data AS setup_states_setup_data, setup_states.last_error AS setup_states_last_error, setup_states.error_count AS setup_states_error_count, setup_states.started_at AS setup_states_started_at, setup_states.completed_at AS setup_states_completed_at, setup_states.updated_at AS setup_states_updated_at 
FROM setup_states
 LIMIT ? OFFSET ?
2025-09-28 11:12:51,951 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] (1, 0)
2025-09-28 11:12:51,958 - sqlalchemy.engine.Engine - INFO - INSERT INTO setup_states (company_created, admin_created, database_initialized, system_configured, setup_data, last_error, error_count, completed_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id, started_at
2025-09-28 11:12:51,959 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] (1, 0, 0, 0, None, None, 0, None, None)
2025-09-28 11:12:51,960 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:12:51,977 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:12:51,978 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies 
WHERE companies.id = ?
2025-09-28 11:12:51,979 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] (1,)
2025-09-28 11:12:51,983 - app.services.setup_service - INFO - Company created successfully: Test Company
2025-09-28 11:12:51,992 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.is_admin = 1
 LIMIT ? OFFSET ?
2025-09-28 11:12:51,992 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] (1, 0)
2025-09-28 11:12:51,996 - app.services.setup_service - ERROR - Unexpected error creating admin user: bcrypt: no backends available -- recommend you install one (e.g. 'pip install bcrypt')
2025-09-28 11:12:51,996 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:12:51,996 - app.models.base - ERROR - Unexpected database error: 400: Error creating admin user: Unexpected error: bcrypt: no backends available -- recommend you install one (e.g. 'pip install bcrypt')
2025-09-28 11:13:04,780 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:13:04,781 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-28 11:13:04,781 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:13:04,783 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-28 11:13:04,783 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:13:04,783 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-28 11:13:04,783 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:13:04,787 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-28 11:13:04,787 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:13:04,787 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-28 11:13:04,788 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:13:04,788 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-28 11:13:04,788 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:13:04,788 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-28 11:13:04,788 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:13:04,789 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-28 11:13:04,789 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:13:04,789 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-28 11:13:04,789 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:13:04,789 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-28 11:13:04,789 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:13:04,794 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-28 11:13:04,794 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:13:04,794 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-28 11:13:04,794 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:13:04,795 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("companies")
2025-09-28 11:13:04,795 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:13:04,795 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("setup_states")
2025-09-28 11:13:04,795 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:13:04,796 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:13:04,796 - __main__ - INFO - Database tables created successfully
2025-09-28 11:13:04,992 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-28 11:13:04,992 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-28 11:13:04,993 - app.services.scheduler_service - INFO - Scheduler started
2025-09-28 11:13:04,993 - app.services.scheduler_service - INFO - All background tasks started
2025-09-28 11:13:04,993 - __main__ - INFO - Application started with background tasks
2025-09-28 11:13:11,260 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:13:11,260 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:13:11,261 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ()
2025-09-28 11:13:11,352 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies
 LIMIT ? OFFSET ?
2025-09-28 11:13:11,353 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] (1, 0)
2025-09-28 11:13:11,354 - app.models.base - ERROR - Unexpected database error: 400: Error creating company: Company already exists
2025-09-28 11:13:11,354 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:13:16,108 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:13:16,109 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:13:16,109 - sqlalchemy.engine.Engine - INFO - [cached since 4.849s ago] ()
2025-09-28 11:13:16,114 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies
 LIMIT ? OFFSET ?
2025-09-28 11:13:16,114 - sqlalchemy.engine.Engine - INFO - [cached since 4.762s ago] (1, 0)
2025-09-28 11:13:16,121 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.is_admin = 1
 LIMIT ? OFFSET ?
2025-09-28 11:13:16,121 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] (1, 0)
2025-09-28 11:13:16,123 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:13:20,138 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:13:20,139 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:13:20,139 - sqlalchemy.engine.Engine - INFO - [cached since 8.878s ago] ()
2025-09-28 11:13:20,140 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.is_admin = 1
 LIMIT ? OFFSET ?
2025-09-28 11:13:20,140 - sqlalchemy.engine.Engine - INFO - [cached since 4.019s ago] (1, 0)
2025-09-28 11:13:20,142 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-09-28 11:13:20,165 - app.services.setup_service - ERROR - Unexpected error creating admin user: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
2025-09-28 11:13:20,166 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:13:20,167 - app.models.base - ERROR - Unexpected database error: 400: Unexpected error: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
2025-09-28 11:13:26,449 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:13:26,449 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:13:26,450 - sqlalchemy.engine.Engine - INFO - [cached since 15.19s ago] ()
2025-09-28 11:13:26,451 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.is_admin = 1
 LIMIT ? OFFSET ?
2025-09-28 11:13:26,451 - sqlalchemy.engine.Engine - INFO - [cached since 10.33s ago] (1, 0)
2025-09-28 11:13:26,452 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-09-28 11:13:26,469 - app.services.setup_service - ERROR - Unexpected error creating admin user: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
2025-09-28 11:13:26,474 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:13:26,475 - app.models.base - ERROR - Unexpected database error: 400: Unexpected error: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
2025-09-28 11:13:34,126 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:13:34,127 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:13:34,127 - sqlalchemy.engine.Engine - INFO - [cached since 22.87s ago] ()
2025-09-28 11:13:34,129 - sqlalchemy.engine.Engine - INFO - DELETE FROM staff
2025-09-28 11:13:34,129 - sqlalchemy.engine.Engine - INFO - [generated in 0.00045s] ()
2025-09-28 11:13:34,130 - sqlalchemy.engine.Engine - INFO - DELETE FROM companies
2025-09-28 11:13:34,130 - sqlalchemy.engine.Engine - INFO - [generated in 0.00021s] ()
2025-09-28 11:13:34,134 - sqlalchemy.engine.Engine - INFO - DELETE FROM setup_states
2025-09-28 11:13:34,134 - sqlalchemy.engine.Engine - INFO - [generated in 0.00021s] ()
2025-09-28 11:13:34,135 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:13:34,149 - app.services.setup_service - INFO - Setup reset successfully
2025-09-28 11:13:40,088 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:13:40,088 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:13:40,088 - sqlalchemy.engine.Engine - INFO - [cached since 28.83s ago] ()
2025-09-28 11:13:40,089 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies
 LIMIT ? OFFSET ?
2025-09-28 11:13:40,090 - sqlalchemy.engine.Engine - INFO - [cached since 28.74s ago] (1, 0)
2025-09-28 11:13:40,090 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:13:41,083 - app.services.scheduler_service - INFO - Scheduler stopped
2025-09-28 11:13:41,084 - app.services.scheduler_service - INFO - All background tasks stopped
2025-09-28 11:13:41,084 - __main__ - INFO - Application shutdown with background tasks stopped
2025-09-28 11:13:48,545 - app.services.scheduler_service - INFO - Scheduler stopped
2025-09-28 11:13:48,545 - app.services.scheduler_service - INFO - All background tasks stopped
2025-09-28 11:13:48,545 - __main__ - INFO - Application shutdown with background tasks stopped
2025-09-28 11:16:22,839 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:16:22,839 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-28 11:16:22,839 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:16:22,841 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-28 11:16:22,841 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:16:22,841 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-28 11:16:22,841 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:16:22,841 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-28 11:16:22,841 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:16:22,842 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-28 11:16:22,842 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:16:22,842 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-28 11:16:22,842 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:16:22,842 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-28 11:16:22,842 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:16:22,842 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-28 11:16:22,842 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:16:22,843 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-28 11:16:22,843 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:16:22,843 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-28 11:16:22,843 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:16:22,843 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-28 11:16:22,843 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:16:22,843 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-28 11:16:22,843 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:16:22,844 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("companies")
2025-09-28 11:16:22,844 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:16:22,844 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("setup_states")
2025-09-28 11:16:22,844 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:16:22,845 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:16:22,845 - __main__ - INFO - Database tables created successfully
2025-09-28 11:16:22,950 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-28 11:16:22,950 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-28 11:16:22,954 - app.services.scheduler_service - INFO - Scheduler started
2025-09-28 11:16:22,954 - app.services.scheduler_service - INFO - All background tasks started
2025-09-28 11:16:22,954 - __main__ - INFO - Application started with background tasks
2025-09-28 11:16:37,077 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:16:37,077 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:16:37,077 - sqlalchemy.engine.Engine - INFO - [cached since 205.8s ago] ()
2025-09-28 11:16:37,078 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies
 LIMIT ? OFFSET ?
2025-09-28 11:16:37,079 - sqlalchemy.engine.Engine - INFO - [cached since 205.7s ago] (1, 0)
2025-09-28 11:16:37,079 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:16:41,732 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:16:41,733 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:16:41,733 - sqlalchemy.engine.Engine - INFO - [cached since 210.5s ago] ()
2025-09-28 11:16:41,734 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies
 LIMIT ? OFFSET ?
2025-09-28 11:16:41,734 - sqlalchemy.engine.Engine - INFO - [cached since 210.4s ago] (1, 0)
2025-09-28 11:16:41,737 - sqlalchemy.engine.Engine - INFO - INSERT INTO companies (name, address, phone, industry_type, timezone, currency, working_hours_start, working_hours_end, is_setup_complete, setup_completed_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id, created_at
2025-09-28 11:16:41,737 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ('Test Company', '123 Test Street', '+1234567890', 'Technology', 'UTC', 'USD', '09:00', '17:00', 0, None, None)
2025-09-28 11:16:41,739 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:16:41,745 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:16:41,747 - sqlalchemy.engine.Engine - INFO - SELECT companies.id, companies.name, companies.address, companies.phone, companies.industry_type, companies.timezone, companies.currency, companies.working_hours_start, companies.working_hours_end, companies.is_setup_complete, companies.setup_completed_at, companies.created_at, companies.updated_at 
FROM companies 
WHERE companies.id = ?
2025-09-28 11:16:41,747 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] (1,)
2025-09-28 11:16:41,757 - sqlalchemy.engine.Engine - INFO - SELECT setup_states.id AS setup_states_id, setup_states.company_created AS setup_states_company_created, setup_states.admin_created AS setup_states_admin_created, setup_states.database_initialized AS setup_states_database_initialized, setup_states.system_configured AS setup_states_system_configured, setup_states.setup_data AS setup_states_setup_data, setup_states.last_error AS setup_states_last_error, setup_states.error_count AS setup_states_error_count, setup_states.started_at AS setup_states_started_at, setup_states.completed_at AS setup_states_completed_at, setup_states.updated_at AS setup_states_updated_at 
FROM setup_states
 LIMIT ? OFFSET ?
2025-09-28 11:16:41,757 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] (1, 0)
2025-09-28 11:16:41,759 - sqlalchemy.engine.Engine - INFO - INSERT INTO setup_states (company_created, admin_created, database_initialized, system_configured, setup_data, last_error, error_count, completed_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id, started_at
2025-09-28 11:16:41,759 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] (1, 0, 0, 0, None, None, 0, None, None)
2025-09-28 11:16:41,760 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:16:41,767 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:16:41,769 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies 
WHERE companies.id = ?
2025-09-28 11:16:41,769 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] (1,)
2025-09-28 11:16:41,769 - app.services.setup_service - INFO - Company created successfully: Test Company
2025-09-28 11:16:41,776 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.is_admin = 1
 LIMIT ? OFFSET ?
2025-09-28 11:16:41,777 - sqlalchemy.engine.Engine - INFO - [cached since 205.7s ago] (1, 0)
2025-09-28 11:16:41,777 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-09-28 11:16:41,788 - app.services.setup_service - ERROR - Unexpected error creating admin user: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
2025-09-28 11:16:41,788 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:16:41,789 - app.models.base - ERROR - Unexpected database error: 400: Error creating admin user: Unexpected error: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
2025-09-28 11:17:22,951 - app.services.scheduler_service - INFO - Scheduler stopped
2025-09-28 11:17:22,952 - app.services.scheduler_service - INFO - All background tasks stopped
2025-09-28 11:17:22,952 - __main__ - INFO - Application shutdown with background tasks stopped
2025-09-28 11:17:43,529 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:17:43,529 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-28 11:17:43,529 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:17:43,530 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-28 11:17:43,531 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:17:43,531 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-28 11:17:43,531 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:17:43,531 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-28 11:17:43,531 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:17:43,531 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-28 11:17:43,531 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:17:43,532 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-28 11:17:43,532 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:17:43,532 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-28 11:17:43,532 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:17:43,532 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-28 11:17:43,532 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:17:43,532 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-28 11:17:43,532 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:17:43,532 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-28 11:17:43,532 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:17:43,533 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-28 11:17:43,533 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:17:43,533 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-28 11:17:43,533 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:17:43,533 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("companies")
2025-09-28 11:17:43,533 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:17:43,533 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("setup_states")
2025-09-28 11:17:43,534 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:17:43,534 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:17:43,534 - __main__ - INFO - Database tables created successfully
2025-09-28 11:17:43,617 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-28 11:17:43,618 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-28 11:17:43,622 - app.services.scheduler_service - INFO - Scheduler started
2025-09-28 11:17:43,622 - app.services.scheduler_service - INFO - All background tasks started
2025-09-28 11:17:43,622 - __main__ - INFO - Application started with background tasks
2025-09-28 11:17:54,514 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:17:54,515 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:17:54,515 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] ()
2025-09-28 11:17:54,604 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies
 LIMIT ? OFFSET ?
2025-09-28 11:17:54,604 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] (1, 0)
2025-09-28 11:17:54,606 - app.models.base - ERROR - Unexpected database error: 400: Error creating company: Company already exists
2025-09-28 11:17:54,606 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:17:57,304 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:17:57,305 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:17:57,305 - sqlalchemy.engine.Engine - INFO - [cached since 2.79s ago] ()
2025-09-28 11:17:57,307 - sqlalchemy.engine.Engine - INFO - DELETE FROM staff
2025-09-28 11:17:57,307 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] ()
2025-09-28 11:17:57,308 - sqlalchemy.engine.Engine - INFO - DELETE FROM companies
2025-09-28 11:17:57,309 - sqlalchemy.engine.Engine - INFO - [generated in 0.00021s] ()
2025-09-28 11:17:57,313 - sqlalchemy.engine.Engine - INFO - DELETE FROM setup_states
2025-09-28 11:17:57,313 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s] ()
2025-09-28 11:17:57,313 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:17:57,321 - app.services.setup_service - INFO - Setup reset successfully
2025-09-28 11:18:00,955 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:18:00,956 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:18:00,956 - sqlalchemy.engine.Engine - INFO - [cached since 6.441s ago] ()
2025-09-28 11:18:00,957 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies
 LIMIT ? OFFSET ?
2025-09-28 11:18:00,957 - sqlalchemy.engine.Engine - INFO - [cached since 6.354s ago] (1, 0)
2025-09-28 11:18:00,965 - sqlalchemy.engine.Engine - INFO - INSERT INTO companies (name, address, phone, industry_type, timezone, currency, working_hours_start, working_hours_end, is_setup_complete, setup_completed_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id, created_at
2025-09-28 11:18:00,965 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] ('Test Company', '123 Test Street', '+1234567890', 'Technology', 'UTC', 'USD', '09:00', '17:00', 0, None, None)
2025-09-28 11:18:00,966 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:18:00,974 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:18:00,975 - sqlalchemy.engine.Engine - INFO - SELECT companies.id, companies.name, companies.address, companies.phone, companies.industry_type, companies.timezone, companies.currency, companies.working_hours_start, companies.working_hours_end, companies.is_setup_complete, companies.setup_completed_at, companies.created_at, companies.updated_at 
FROM companies 
WHERE companies.id = ?
2025-09-28 11:18:00,975 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] (1,)
2025-09-28 11:18:00,983 - sqlalchemy.engine.Engine - INFO - SELECT setup_states.id AS setup_states_id, setup_states.company_created AS setup_states_company_created, setup_states.admin_created AS setup_states_admin_created, setup_states.database_initialized AS setup_states_database_initialized, setup_states.system_configured AS setup_states_system_configured, setup_states.setup_data AS setup_states_setup_data, setup_states.last_error AS setup_states_last_error, setup_states.error_count AS setup_states_error_count, setup_states.started_at AS setup_states_started_at, setup_states.completed_at AS setup_states_completed_at, setup_states.updated_at AS setup_states_updated_at 
FROM setup_states
 LIMIT ? OFFSET ?
2025-09-28 11:18:00,984 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] (1, 0)
2025-09-28 11:18:00,992 - sqlalchemy.engine.Engine - INFO - INSERT INTO setup_states (company_created, admin_created, database_initialized, system_configured, setup_data, last_error, error_count, completed_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id, started_at
2025-09-28 11:18:00,992 - sqlalchemy.engine.Engine - INFO - [generated in 0.00662s] (1, 0, 0, 0, None, None, 0, None, None)
2025-09-28 11:18:00,993 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:18:00,998 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:18:01,004 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies 
WHERE companies.id = ?
2025-09-28 11:18:01,004 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] (1,)
2025-09-28 11:18:01,006 - app.services.setup_service - INFO - Company created successfully: Test Company
2025-09-28 11:18:01,010 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.is_admin = 1
 LIMIT ? OFFSET ?
2025-09-28 11:18:01,010 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] (1, 0)
2025-09-28 11:18:01,017 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-09-28 11:18:01,037 - sqlalchemy.engine.Engine - INFO - INSERT INTO staff (employee_code, name, email, password_hash, phone, basic_salary, incentive_percentage, department, joining_date, is_active, is_admin, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) RETURNING id, created_at, updated_at
2025-09-28 11:18:01,037 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ('ADMIN20250928111801', 'Admin User', 'admin@test.com', '9b8769a4a742959a2d0298c36fb70623f2dfacda8436237df08d8dfd5b37374c', '+1234567890', 0.0, 0.0, None, '2025-09-28', 1, 1)
2025-09-28 11:18:01,042 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:18:01,057 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:18:01,058 - sqlalchemy.engine.Engine - INFO - SELECT staff.id, staff.employee_code, staff.name, staff.email, staff.password_hash, staff.phone, staff.basic_salary, staff.incentive_percentage, staff.department, staff.joining_date, staff.is_active, staff.is_admin, staff.created_at, staff.updated_at 
FROM staff 
WHERE staff.id = ?
2025-09-28 11:18:01,058 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] (1,)
2025-09-28 11:18:01,059 - sqlalchemy.engine.Engine - INFO - SELECT setup_states.id AS setup_states_id, setup_states.company_created AS setup_states_company_created, setup_states.admin_created AS setup_states_admin_created, setup_states.database_initialized AS setup_states_database_initialized, setup_states.system_configured AS setup_states_system_configured, setup_states.setup_data AS setup_states_setup_data, setup_states.last_error AS setup_states_last_error, setup_states.error_count AS setup_states_error_count, setup_states.started_at AS setup_states_started_at, setup_states.completed_at AS setup_states_completed_at, setup_states.updated_at AS setup_states_updated_at 
FROM setup_states
 LIMIT ? OFFSET ?
2025-09-28 11:18:01,059 - sqlalchemy.engine.Engine - INFO - [cached since 0.07626s ago] (1, 0)
2025-09-28 11:18:01,062 - sqlalchemy.engine.Engine - INFO - UPDATE setup_states SET admin_created=?, updated_at=CURRENT_TIMESTAMP WHERE setup_states.id = ?
2025-09-28 11:18:01,062 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] (1, 1)
2025-09-28 11:18:01,063 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:18:01,071 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:18:01,073 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.id = ?
2025-09-28 11:18:01,073 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] (1,)
2025-09-28 11:18:01,076 - app.services.setup_service - INFO - Admin user created successfully: Admin User
2025-09-28 11:18:01,078 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies
 LIMIT ? OFFSET ?
2025-09-28 11:18:01,081 - sqlalchemy.engine.Engine - INFO - [cached since 6.477s ago] (1, 0)
2025-09-28 11:18:01,082 - sqlalchemy.engine.Engine - INFO - UPDATE companies SET is_setup_complete=?, setup_completed_at=?, updated_at=CURRENT_TIMESTAMP WHERE companies.id = ?
2025-09-28 11:18:01,082 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] (1, '2025-09-28 11:18:01.081738', 1)
2025-09-28 11:18:01,083 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:18:01,090 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:18:01,090 - sqlalchemy.engine.Engine - INFO - SELECT setup_states.id AS setup_states_id, setup_states.company_created AS setup_states_company_created, setup_states.admin_created AS setup_states_admin_created, setup_states.database_initialized AS setup_states_database_initialized, setup_states.system_configured AS setup_states_system_configured, setup_states.setup_data AS setup_states_setup_data, setup_states.last_error AS setup_states_last_error, setup_states.error_count AS setup_states_error_count, setup_states.started_at AS setup_states_started_at, setup_states.completed_at AS setup_states_completed_at, setup_states.updated_at AS setup_states_updated_at 
FROM setup_states
 LIMIT ? OFFSET ?
2025-09-28 11:18:01,091 - sqlalchemy.engine.Engine - INFO - [cached since 0.1075s ago] (1, 0)
2025-09-28 11:18:01,092 - sqlalchemy.engine.Engine - INFO - UPDATE setup_states SET system_configured=?, updated_at=CURRENT_TIMESTAMP WHERE setup_states.id = ?
2025-09-28 11:18:01,092 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] (1, 1)
2025-09-28 11:18:01,093 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:18:01,096 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:18:01,096 - sqlalchemy.engine.Engine - INFO - SELECT setup_states.id AS setup_states_id, setup_states.company_created AS setup_states_company_created, setup_states.admin_created AS setup_states_admin_created, setup_states.database_initialized AS setup_states_database_initialized, setup_states.system_configured AS setup_states_system_configured, setup_states.setup_data AS setup_states_setup_data, setup_states.last_error AS setup_states_last_error, setup_states.error_count AS setup_states_error_count, setup_states.started_at AS setup_states_started_at, setup_states.completed_at AS setup_states_completed_at, setup_states.updated_at AS setup_states_updated_at 
FROM setup_states
 LIMIT ? OFFSET ?
2025-09-28 11:18:01,096 - sqlalchemy.engine.Engine - INFO - [cached since 0.1132s ago] (1, 0)
2025-09-28 11:18:01,097 - sqlalchemy.engine.Engine - INFO - UPDATE setup_states SET database_initialized=?, updated_at=CURRENT_TIMESTAMP WHERE setup_states.id = ?
2025-09-28 11:18:01,098 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] (1, 1)
2025-09-28 11:18:01,098 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:18:01,106 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:18:01,107 - sqlalchemy.engine.Engine - INFO - SELECT setup_states.id AS setup_states_id, setup_states.company_created AS setup_states_company_created, setup_states.admin_created AS setup_states_admin_created, setup_states.database_initialized AS setup_states_database_initialized, setup_states.system_configured AS setup_states_system_configured, setup_states.setup_data AS setup_states_setup_data, setup_states.last_error AS setup_states_last_error, setup_states.error_count AS setup_states_error_count, setup_states.started_at AS setup_states_started_at, setup_states.completed_at AS setup_states_completed_at, setup_states.updated_at AS setup_states_updated_at 
FROM setup_states
 LIMIT ? OFFSET ?
2025-09-28 11:18:01,107 - sqlalchemy.engine.Engine - INFO - [cached since 0.1237s ago] (1, 0)
2025-09-28 11:18:01,108 - sqlalchemy.engine.Engine - INFO - UPDATE setup_states SET setup_data=?, completed_at=?, updated_at=CURRENT_TIMESTAMP WHERE setup_states.id = ?
2025-09-28 11:18:01,108 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] ('{"company_data": {"name": "Test Company", "address": "123 Test Street", "phone": "+1234567890", "industry_type": "Technology", "timezone": "UTC", "cu ... (62 characters truncated) ... _end": "17:00"}, "admin_data": {"name": "Admin User", "email": "admin@test.com", "password": "pass123", "phone": "+1234567890"}, "system_config": {}}', '2025-09-28 11:18:01.107852', 1)
2025-09-28 11:18:01,109 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:18:01,115 - app.services.setup_service - INFO - Setup completed successfully
2025-09-28 11:18:04,350 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:18:04,351 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:18:04,351 - sqlalchemy.engine.Engine - INFO - [cached since 9.836s ago] ()
2025-09-28 11:18:04,354 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:18:04,995 - app.services.scheduler_service - INFO - Scheduler stopped
2025-09-28 11:18:04,996 - app.services.scheduler_service - INFO - All background tasks stopped
2025-09-28 11:18:04,996 - __main__ - INFO - Application shutdown with background tasks stopped
2025-09-28 11:18:12,907 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:18:12,912 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:18:12,912 - sqlalchemy.engine.Engine - INFO - [cached since 18.4s ago] ()
2025-09-28 11:18:12,913 - app.models.base - ERROR - Unexpected database error: 403: Access denied: Not on local network
2025-09-28 11:18:12,913 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:18:14,577 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:18:14,577 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:18:14,577 - sqlalchemy.engine.Engine - INFO - [cached since 20.06s ago] ()
2025-09-28 11:18:14,595 - app.models.base - ERROR - Unexpected database error: 403: Access denied: Not on local network
2025-09-28 11:18:14,598 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:18:27,137 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:18:27,137 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-28 11:18:27,137 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:27,143 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-28 11:18:27,143 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:27,143 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-28 11:18:27,143 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:27,143 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-28 11:18:27,144 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:27,144 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-28 11:18:27,144 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:27,144 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-28 11:18:27,144 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:27,144 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-28 11:18:27,144 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:27,144 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-28 11:18:27,145 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:27,145 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-28 11:18:27,145 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:27,145 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-28 11:18:27,145 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:27,145 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-28 11:18:27,145 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:27,145 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-28 11:18:27,149 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:27,149 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("companies")
2025-09-28 11:18:27,149 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:27,149 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("setup_states")
2025-09-28 11:18:27,149 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:27,150 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:18:27,150 - __main__ - INFO - Database tables created successfully
2025-09-28 11:18:27,348 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-28 11:18:27,348 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-28 11:18:27,352 - app.services.scheduler_service - INFO - Scheduler started
2025-09-28 11:18:27,352 - app.services.scheduler_service - INFO - All background tasks started
2025-09-28 11:18:27,352 - __main__ - INFO - Application started with background tasks
2025-09-28 11:18:30,410 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:18:30,411 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:18:30,411 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] ()
2025-09-28 11:18:30,472 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.employee_code = ? AND staff.is_active = 1
 LIMIT ? OFFSET ?
2025-09-28 11:18:30,472 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] ('ADMIN20250928111801', 1, 0)
2025-09-28 11:18:30,474 - app.models.base - ERROR - Unexpected database error: hash could not be identified
2025-09-28 11:18:30,474 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:18:30,498 - app.utils.error_handler - ERROR - Application Error: {
  "timestamp": "2025-09-28T11:18:30.475261",
  "error_type": "UnknownHashError",
  "error_message": "hash could not be identified",
  "user_id": null,
  "request_url": "http://localhost:8000/api/auth/login",
  "request_method": "POST",
  "client_ip": "127.0.0.1",
  "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/base.py\", line 183, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |                ~~~~~~~~~~~~~~~~~~~~~~~^^\n  |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/anyio/_backends/_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  |         \"unhandled errors in a TaskGroup\", self._exceptions\n  |     ) from None\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/base.py\", line 182, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |                                    ~~~~~~~~~~~~~~~~~~^^\n    |   File \"/usr/lib/python3.13/contextlib.py\", line 162, in __exit__\n    |     self.gen.throw(value)\n    |     ~~~~~~~~~~~~~~^^^^^^^\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/base.py\", line 184, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/workspace/backend/app/middleware/security.py\", line 138, in security_middleware_handler\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/base.py\", line 159, in call_next\n    |     raise app_exc\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 78, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 75, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/fastapi/routing.py\", line 308, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |     ...<3 lines>...\n    |     )\n    |     ^\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/fastapi/routing.py\", line 219, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/workspace/backend/app/routers/auth.py\", line 188, in login\n    |     if not staff or not verify_password(login_data.password, staff.password_hash):\n    |                         ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/workspace/backend/app/utils/auth.py\", line 14, in verify_password\n    |     return pwd_context.verify(plain_password, hashed_password)\n    |            ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/passlib/context.py\", line 2343, in verify\n    |     record = self._get_or_identify_record(hash, scheme, category)\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/passlib/context.py\", line 2031, in _get_or_identify_record\n    |     return self._identify_record(hash, category)\n    |            ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^\n    |   File \"/home/ubuntu/.local/lib/python3.13/site-packages/passlib/context.py\", line 1132, in identify_record\n    |     raise exc.UnknownHashError(\"hash could not be identified\")\n    | passlib.exc.UnknownHashError: hash could not be identified\n    +------------------------------------\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/base.py\", line 182, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"/usr/lib/python3.13/contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/base.py\", line 184, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/workspace/backend/app/middleware/security.py\", line 138, in security_middleware_handler\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/base.py\", line 159, in call_next\n    raise app_exc\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py\", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/fastapi/routing.py\", line 308, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/fastapi/routing.py\", line 219, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/workspace/backend/app/routers/auth.py\", line 188, in login\n    if not staff or not verify_password(login_data.password, staff.password_hash):\n                        ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/workspace/backend/app/utils/auth.py\", line 14, in verify_password\n    return pwd_context.verify(plain_password, hashed_password)\n           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/passlib/context.py\", line 2343, in verify\n    record = self._get_or_identify_record(hash, scheme, category)\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/passlib/context.py\", line 2031, in _get_or_identify_record\n    return self._identify_record(hash, category)\n           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^\n  File \"/home/ubuntu/.local/lib/python3.13/site-packages/passlib/context.py\", line 1132, in identify_record\n    raise exc.UnknownHashError(\"hash could not be identified\")\npasslib.exc.UnknownHashError: hash could not be identified\n"
}
2025-09-28 11:18:40,910 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:18:40,910 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-28 11:18:40,910 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:40,911 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-28 11:18:40,912 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:40,912 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-28 11:18:40,912 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:40,912 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-28 11:18:40,912 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:40,912 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-28 11:18:40,912 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:40,913 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-28 11:18:40,913 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:40,913 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-28 11:18:40,913 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:40,913 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-28 11:18:40,913 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:40,913 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-28 11:18:40,913 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:40,914 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-28 11:18:40,914 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:40,914 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-28 11:18:40,914 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:40,914 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-28 11:18:40,914 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:40,914 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("companies")
2025-09-28 11:18:40,914 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:40,915 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("setup_states")
2025-09-28 11:18:40,915 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-28 11:18:40,915 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-28 11:18:40,916 - __main__ - INFO - Database tables created successfully
2025-09-28 11:18:41,000 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-28 11:18:41,000 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-28 11:18:41,004 - app.services.scheduler_service - INFO - Scheduler started
2025-09-28 11:18:41,004 - app.services.scheduler_service - INFO - All background tasks started
2025-09-28 11:18:41,004 - __main__ - INFO - Application started with background tasks
2025-09-28 11:18:42,834 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:18:42,835 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:18:42,835 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ()
2025-09-28 11:18:42,935 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.employee_code = ? AND staff.is_active = 1
 LIMIT ? OFFSET ?
2025-09-28 11:18:42,935 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] ('ADMIN20250928111801', 1, 0)
2025-09-28 11:18:42,944 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:18:43,618 - app.services.scheduler_service - INFO - Scheduler stopped
2025-09-28 11:18:43,619 - app.services.scheduler_service - INFO - All background tasks stopped
2025-09-28 11:18:43,619 - __main__ - INFO - Application shutdown with background tasks stopped
2025-09-28 11:18:46,732 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:18:46,733 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:18:46,733 - sqlalchemy.engine.Engine - INFO - [cached since 3.898s ago] ()
2025-09-28 11:18:46,735 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.id = ?
 LIMIT ? OFFSET ?
2025-09-28 11:18:46,736 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] ('1', 1, 0)
2025-09-28 11:18:46,738 - sqlalchemy.engine.Engine - INFO - SELECT count(staff.id) AS count_1 
FROM staff 
WHERE staff.is_active = 1
2025-09-28 11:18:46,739 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] ()
2025-09-28 11:18:46,744 - sqlalchemy.engine.Engine - INFO - SELECT sum(sales.sale_amount) AS sum_1 
FROM sales 
WHERE sales.sale_date = ?
2025-09-28 11:18:46,745 - sqlalchemy.engine.Engine - INFO - [generated in 0.00076s] ('2025-09-28',)
2025-09-28 11:18:46,747 - sqlalchemy.engine.Engine - INFO - SELECT sum(sales.sale_amount) AS sum_1 
FROM sales 
WHERE sales.sale_date >= ?
2025-09-28 11:18:46,747 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ('2025-09-01',)
2025-09-28 11:18:46,749 - sqlalchemy.engine.Engine - INFO - SELECT count(salary.id) AS count_1 
FROM salary 
WHERE salary.payment_status = ?
2025-09-28 11:18:46,749 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] ('PENDING',)
2025-09-28 11:18:46,754 - sqlalchemy.engine.Engine - INFO - SELECT count(advances.id) AS count_1 
FROM advances 
WHERE advances.status = ?
2025-09-28 11:18:46,755 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] ('ACTIVE',)
2025-09-28 11:18:46,756 - sqlalchemy.engine.Engine - INFO - SELECT count(attendance.id) AS count_1 
FROM attendance 
WHERE attendance.date = ? AND attendance.status = ?
2025-09-28 11:18:46,756 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] ('2025-09-28', 'PRESENT')
2025-09-28 11:18:46,761 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:18:49,709 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:18:49,709 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:18:49,709 - sqlalchemy.engine.Engine - INFO - [cached since 6.875s ago] ()
2025-09-28 11:18:49,711 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.id = ?
 LIMIT ? OFFSET ?
2025-09-28 11:18:49,711 - sqlalchemy.engine.Engine - INFO - [cached since 2.976s ago] ('1', 1, 0)
2025-09-28 11:18:49,712 - sqlalchemy.engine.Engine - INFO - SELECT count(staff.id) AS count_1 
FROM staff 
WHERE staff.is_active = 1
2025-09-28 11:18:49,713 - sqlalchemy.engine.Engine - INFO - [cached since 2.974s ago] ()
2025-09-28 11:18:49,713 - sqlalchemy.engine.Engine - INFO - SELECT sum(sales.sale_amount) AS sum_1 
FROM sales 
WHERE sales.sale_date = ?
2025-09-28 11:18:49,713 - sqlalchemy.engine.Engine - INFO - [cached since 2.97s ago] ('2025-09-28',)
2025-09-28 11:18:49,714 - sqlalchemy.engine.Engine - INFO - SELECT sum(sales.sale_amount) AS sum_1 
FROM sales 
WHERE sales.sale_date >= ?
2025-09-28 11:18:49,714 - sqlalchemy.engine.Engine - INFO - [cached since 2.967s ago] ('2025-09-01',)
2025-09-28 11:18:49,715 - sqlalchemy.engine.Engine - INFO - SELECT count(salary.id) AS count_1 
FROM salary 
WHERE salary.payment_status = ?
2025-09-28 11:18:49,715 - sqlalchemy.engine.Engine - INFO - [cached since 2.966s ago] ('PENDING',)
2025-09-28 11:18:49,715 - sqlalchemy.engine.Engine - INFO - SELECT count(advances.id) AS count_1 
FROM advances 
WHERE advances.status = ?
2025-09-28 11:18:49,715 - sqlalchemy.engine.Engine - INFO - [cached since 2.961s ago] ('ACTIVE',)
2025-09-28 11:18:49,721 - sqlalchemy.engine.Engine - INFO - SELECT count(attendance.id) AS count_1 
FROM attendance 
WHERE attendance.date = ? AND attendance.status = ?
2025-09-28 11:18:49,721 - sqlalchemy.engine.Engine - INFO - [cached since 2.965s ago] ('2025-09-28', 'PRESENT')
2025-09-28 11:18:49,722 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:18:54,746 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:18:54,747 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:18:54,747 - sqlalchemy.engine.Engine - INFO - [cached since 11.91s ago] ()
2025-09-28 11:18:54,748 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.id = ?
 LIMIT ? OFFSET ?
2025-09-28 11:18:54,748 - sqlalchemy.engine.Engine - INFO - [cached since 8.013s ago] ('1', 1, 0)
2025-09-28 11:18:54,752 - sqlalchemy.engine.Engine - INFO - SELECT attendance.id AS attendance_id, attendance.staff_id AS attendance_staff_id, attendance.check_in_time AS attendance_check_in_time, attendance.check_out_time AS attendance_check_out_time, attendance.date AS attendance_date, attendance.wifi_mac_address AS attendance_wifi_mac_address, attendance.ip_address AS attendance_ip_address, attendance.device_fingerprint AS attendance_device_fingerprint, attendance.status AS attendance_status, attendance.created_at AS attendance_created_at 
FROM attendance 
WHERE attendance.staff_id = ? AND attendance.date = ?
 LIMIT ? OFFSET ?
2025-09-28 11:18:54,752 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] (1, '2025-09-28', 1, 0)
2025-09-28 11:18:54,757 - sqlalchemy.engine.Engine - INFO - SELECT sum(sales.sale_amount) AS sum_1 
FROM sales 
WHERE sales.staff_id = ? AND sales.sale_date = ?
2025-09-28 11:18:54,757 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] (1, '2025-09-28')
2025-09-28 11:18:54,760 - sqlalchemy.engine.Engine - INFO - SELECT sum(sales.sale_amount) AS sum_1 
FROM sales 
WHERE sales.staff_id = ? AND sales.sale_date >= ? AND sales.sale_date <= ?
2025-09-28 11:18:54,760 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] (1, '2025-09-01', '2025-09-28')
2025-09-28 11:18:54,763 - sqlalchemy.engine.Engine - INFO - SELECT targets.id AS targets_id, targets.staff_id AS targets_staff_id, targets.target_type AS targets_target_type, targets.total_target_amount AS targets_total_target_amount, targets.brand_wise_targets AS targets_brand_wise_targets, targets.period_start AS targets_period_start, targets.period_end AS targets_period_end, targets.incentive_percentage AS targets_incentive_percentage, targets.created_at AS targets_created_at 
FROM targets 
WHERE targets.staff_id = ? AND targets.period_start <= ? AND targets.period_end >= ? AND targets.target_type = ?
 LIMIT ? OFFSET ?
2025-09-28 11:18:54,763 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] (1, '2025-09-28', '2025-09-28', 'MONTHLY', 1, 0)
2025-09-28 11:18:54,770 - sqlalchemy.engine.Engine - INFO - SELECT count(attendance.id) AS count_1 
FROM attendance 
WHERE attendance.staff_id = ? AND attendance.status = ? AND attendance.date >= ?
2025-09-28 11:18:54,770 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] (1, 'PRESENT', '2025-09-01')
2025-09-28 11:18:54,771 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:19:16,327 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:19:16,328 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:19:16,328 - sqlalchemy.engine.Engine - INFO - [cached since 33.49s ago] ()
2025-09-28 11:19:16,330 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.id = ?
 LIMIT ? OFFSET ?
2025-09-28 11:19:16,330 - sqlalchemy.engine.Engine - INFO - [cached since 29.59s ago] ('1', 1, 0)
2025-09-28 11:19:16,332 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff
 LIMIT ? OFFSET ?
2025-09-28 11:19:16,332 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] (100, 0)
2025-09-28 11:19:16,333 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:19:25,487 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:19:25,487 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:19:25,488 - sqlalchemy.engine.Engine - INFO - [cached since 42.65s ago] ()
2025-09-28 11:19:25,490 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies
 LIMIT ? OFFSET ?
2025-09-28 11:19:25,490 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] (1, 0)
2025-09-28 11:19:25,528 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.is_admin = 1
 LIMIT ? OFFSET ?
2025-09-28 11:19:25,529 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] (1, 0)
2025-09-28 11:19:25,531 - sqlalchemy.engine.Engine - INFO - SELECT setup_states.id AS setup_states_id, setup_states.company_created AS setup_states_company_created, setup_states.admin_created AS setup_states_admin_created, setup_states.database_initialized AS setup_states_database_initialized, setup_states.system_configured AS setup_states_system_configured, setup_states.setup_data AS setup_states_setup_data, setup_states.last_error AS setup_states_last_error, setup_states.error_count AS setup_states_error_count, setup_states.started_at AS setup_states_started_at, setup_states.completed_at AS setup_states_completed_at, setup_states.updated_at AS setup_states_updated_at 
FROM setup_states
 LIMIT ? OFFSET ?
2025-09-28 11:19:25,531 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] (1, 0)
2025-09-28 11:19:25,532 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:19:27,349 - app.services.scheduler_service - INFO - Scheduler stopped
2025-09-28 11:19:27,349 - app.services.scheduler_service - INFO - All background tasks stopped
2025-09-28 11:19:27,349 - __main__ - INFO - Application shutdown with background tasks stopped
2025-09-28 11:21:11,476 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:21:11,476 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:21:11,476 - sqlalchemy.engine.Engine - INFO - [cached since 148.6s ago] ()
2025-09-28 11:21:11,478 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.employee_code = ? AND staff.is_active = 1
 LIMIT ? OFFSET ?
2025-09-28 11:21:11,478 - sqlalchemy.engine.Engine - INFO - [cached since 148.5s ago] ('ADMIN20250928111801', 1, 0)
2025-09-28 11:21:11,480 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:21:13,754 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:21:13,754 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:21:13,754 - sqlalchemy.engine.Engine - INFO - [cached since 150.9s ago] ()
2025-09-28 11:21:13,756 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.employee_code = ? AND staff.is_active = 1
 LIMIT ? OFFSET ?
2025-09-28 11:21:13,756 - sqlalchemy.engine.Engine - INFO - [cached since 150.8s ago] ('ADMIN20250928111801', 1, 0)
2025-09-28 11:21:13,757 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:21:18,671 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:21:18,671 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:21:18,671 - sqlalchemy.engine.Engine - INFO - [cached since 155.8s ago] ()
2025-09-28 11:21:18,679 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.id = ?
 LIMIT ? OFFSET ?
2025-09-28 11:21:18,679 - sqlalchemy.engine.Engine - INFO - [cached since 151.9s ago] ('1', 1, 0)
2025-09-28 11:21:18,680 - sqlalchemy.engine.Engine - INFO - SELECT count(staff.id) AS count_1 
FROM staff 
WHERE staff.is_active = 1
2025-09-28 11:21:18,680 - sqlalchemy.engine.Engine - INFO - [cached since 151.9s ago] ()
2025-09-28 11:21:18,681 - sqlalchemy.engine.Engine - INFO - SELECT sum(sales.sale_amount) AS sum_1 
FROM sales 
WHERE sales.sale_date = ?
2025-09-28 11:21:18,681 - sqlalchemy.engine.Engine - INFO - [cached since 151.9s ago] ('2025-09-28',)
2025-09-28 11:21:18,682 - sqlalchemy.engine.Engine - INFO - SELECT sum(sales.sale_amount) AS sum_1 
FROM sales 
WHERE sales.sale_date >= ?
2025-09-28 11:21:18,682 - sqlalchemy.engine.Engine - INFO - [cached since 151.9s ago] ('2025-09-01',)
2025-09-28 11:21:18,683 - sqlalchemy.engine.Engine - INFO - SELECT count(salary.id) AS count_1 
FROM salary 
WHERE salary.payment_status = ?
2025-09-28 11:21:18,683 - sqlalchemy.engine.Engine - INFO - [cached since 151.9s ago] ('PENDING',)
2025-09-28 11:21:18,683 - sqlalchemy.engine.Engine - INFO - SELECT count(advances.id) AS count_1 
FROM advances 
WHERE advances.status = ?
2025-09-28 11:21:18,686 - sqlalchemy.engine.Engine - INFO - [cached since 151.9s ago] ('ACTIVE',)
2025-09-28 11:21:18,687 - sqlalchemy.engine.Engine - INFO - SELECT count(attendance.id) AS count_1 
FROM attendance 
WHERE attendance.date = ? AND attendance.status = ?
2025-09-28 11:21:18,687 - sqlalchemy.engine.Engine - INFO - [cached since 151.9s ago] ('2025-09-28', 'PRESENT')
2025-09-28 11:21:18,688 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:22:01,191 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:22:01,193 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:22:01,193 - sqlalchemy.engine.Engine - INFO - [cached since 198.4s ago] ()
2025-09-28 11:22:01,196 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.id = ?
 LIMIT ? OFFSET ?
2025-09-28 11:22:01,196 - sqlalchemy.engine.Engine - INFO - [cached since 194.5s ago] ('1', 1, 0)
2025-09-28 11:22:01,198 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff
 LIMIT ? OFFSET ?
2025-09-28 11:22:01,198 - sqlalchemy.engine.Engine - INFO - [cached since 164.9s ago] (100, 0)
2025-09-28 11:22:01,199 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-28 11:24:25,968 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-28 11:24:25,969 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-28 11:24:25,969 - sqlalchemy.engine.Engine - INFO - [cached since 343.1s ago] ()
2025-09-28 11:24:25,977 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.id = ?
 LIMIT ? OFFSET ?
2025-09-28 11:24:25,977 - sqlalchemy.engine.Engine - INFO - [cached since 339.2s ago] ('1', 1, 0)
2025-09-28 11:24:25,983 - sqlalchemy.engine.Engine - INFO - SELECT attendance.id AS attendance_id, attendance.staff_id AS attendance_staff_id, attendance.check_in_time AS attendance_check_in_time, attendance.check_out_time AS attendance_check_out_time, attendance.date AS attendance_date, attendance.wifi_mac_address AS attendance_wifi_mac_address, attendance.ip_address AS attendance_ip_address, attendance.device_fingerprint AS attendance_device_fingerprint, attendance.status AS attendance_status, attendance.created_at AS attendance_created_at 
FROM attendance 
WHERE attendance.staff_id = ? AND attendance.date = ?
 LIMIT ? OFFSET ?
2025-09-28 11:24:25,983 - sqlalchemy.engine.Engine - INFO - [cached since 331.2s ago] (1, '2025-09-28', 1, 0)
2025-09-28 11:24:25,984 - sqlalchemy.engine.Engine - INFO - SELECT sum(sales.sale_amount) AS sum_1 
FROM sales 
WHERE sales.staff_id = ? AND sales.sale_date = ?
2025-09-28 11:24:25,984 - sqlalchemy.engine.Engine - INFO - [cached since 331.2s ago] (1, '2025-09-28')
2025-09-28 11:24:25,985 - sqlalchemy.engine.Engine - INFO - SELECT sum(sales.sale_amount) AS sum_1 
FROM sales 
WHERE sales.staff_id = ? AND sales.sale_date >= ? AND sales.sale_date <= ?
2025-09-28 11:24:25,985 - sqlalchemy.engine.Engine - INFO - [cached since 331.2s ago] (1, '2025-09-01', '2025-09-28')
2025-09-28 11:24:25,986 - sqlalchemy.engine.Engine - INFO - SELECT targets.id AS targets_id, targets.staff_id AS targets_staff_id, targets.target_type AS targets_target_type, targets.total_target_amount AS targets_total_target_amount, targets.brand_wise_targets AS targets_brand_wise_targets, targets.period_start AS targets_period_start, targets.period_end AS targets_period_end, targets.incentive_percentage AS targets_incentive_percentage, targets.created_at AS targets_created_at 
FROM targets 
WHERE targets.staff_id = ? AND targets.period_start <= ? AND targets.period_end >= ? AND targets.target_type = ?
 LIMIT ? OFFSET ?
2025-09-28 11:24:25,986 - sqlalchemy.engine.Engine - INFO - [cached since 331.2s ago] (1, '2025-09-28', '2025-09-28', 'MONTHLY', 1, 0)
2025-09-28 11:24:25,987 - sqlalchemy.engine.Engine - INFO - SELECT count(attendance.id) AS count_1 
FROM attendance 
WHERE attendance.staff_id = ? AND attendance.status = ? AND attendance.date >= ?
2025-09-28 11:24:25,987 - sqlalchemy.engine.Engine - INFO - [cached since 331.2s ago] (1, 'PRESENT', '2025-09-01')
2025-09-28 11:24:25,988 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-29 03:34:26,567 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-29 03:34:26,568 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-29 03:34:26,568 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:34:26,569 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-29 03:34:26,569 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:34:26,569 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-29 03:34:26,570 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:34:26,571 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-29 03:34:26,571 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:34:26,572 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-29 03:34:26,572 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:34:26,572 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-29 03:34:26,572 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:34:26,573 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-29 03:34:26,573 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:34:26,573 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-29 03:34:26,573 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:34:26,574 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-29 03:34:26,574 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:34:26,574 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-29 03:34:26,574 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:34:26,574 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-29 03:34:26,575 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:34:26,575 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-29 03:34:26,575 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:34:26,575 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("companies")
2025-09-29 03:34:26,575 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:34:26,576 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("setup_states")
2025-09-29 03:34:26,576 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:34:26,577 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-29 03:34:26,577 - __main__ - INFO - Database tables created successfully
2025-09-29 03:34:26,736 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-29 03:34:26,737 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-29 03:34:26,737 - app.services.scheduler_service - INFO - Scheduler started
2025-09-29 03:34:26,737 - app.services.scheduler_service - INFO - All background tasks started
2025-09-29 03:34:26,737 - __main__ - INFO - Application started with background tasks
2025-09-29 03:35:26,737 - app.services.scheduler_service - INFO - Scheduler stopped
2025-09-29 03:35:26,738 - app.services.scheduler_service - INFO - All background tasks stopped
2025-09-29 03:35:26,738 - __main__ - INFO - Application shutdown with background tasks stopped
2025-09-29 03:35:36,882 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-29 03:35:36,884 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-29 03:35:36,888 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:35:36,890 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-29 03:35:36,890 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:35:36,890 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-29 03:35:36,890 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:35:36,891 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-29 03:35:36,891 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:35:36,891 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-29 03:35:36,891 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:35:36,891 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-29 03:35:36,891 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:35:36,891 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-29 03:35:36,891 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:35:36,892 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-29 03:35:36,892 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:35:36,892 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-29 03:35:36,892 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:35:36,892 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-29 03:35:36,892 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:35:36,892 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-29 03:35:36,892 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:35:36,893 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-29 03:35:36,893 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:35:36,893 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("companies")
2025-09-29 03:35:36,893 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:35:36,893 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("setup_states")
2025-09-29 03:35:36,893 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:35:36,894 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-29 03:35:36,898 - __main__ - INFO - Database tables created successfully
2025-09-29 03:35:37,198 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-29 03:35:37,198 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-29 03:35:37,202 - app.services.scheduler_service - INFO - Scheduler started
2025-09-29 03:35:37,202 - app.services.scheduler_service - INFO - All background tasks started
2025-09-29 03:35:37,202 - __main__ - INFO - Application started with background tasks
2025-09-29 03:44:54,920 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-29 03:44:54,920 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-29 03:44:54,920 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:44:54,926 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-29 03:44:54,926 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:44:54,926 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-29 03:44:54,926 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:44:54,927 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-29 03:44:54,927 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:44:54,927 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-29 03:44:54,927 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:44:54,927 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-29 03:44:54,927 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:44:54,927 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-29 03:44:54,927 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:44:54,928 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-29 03:44:54,928 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:44:54,928 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-29 03:44:54,928 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:44:54,928 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-29 03:44:54,928 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:44:54,928 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-29 03:44:54,928 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:44:54,933 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-29 03:44:54,933 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:44:54,933 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("companies")
2025-09-29 03:44:54,933 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:44:54,933 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("setup_states")
2025-09-29 03:44:54,933 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:44:54,934 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-29 03:44:54,934 - __main__ - INFO - Database tables created successfully
2025-09-29 03:44:55,288 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-29 03:44:55,288 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-29 03:44:55,292 - app.services.scheduler_service - INFO - Scheduler started
2025-09-29 03:44:55,292 - app.services.scheduler_service - INFO - All background tasks started
2025-09-29 03:44:55,292 - __main__ - INFO - Application started with background tasks
2025-09-29 03:45:37,202 - app.services.scheduler_service - INFO - Scheduler stopped
2025-09-29 03:45:37,202 - app.services.scheduler_service - INFO - All background tasks stopped
2025-09-29 03:45:37,202 - __main__ - INFO - Application shutdown with background tasks stopped
2025-09-29 03:50:53,976 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-29 03:50:53,977 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-29 03:50:53,977 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:50:53,978 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-29 03:50:53,978 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:50:53,978 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-29 03:50:53,978 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:50:53,979 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-29 03:50:53,979 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:50:53,979 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-29 03:50:53,979 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:50:53,979 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-29 03:50:53,979 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:50:53,979 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-29 03:50:53,980 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:50:53,980 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-29 03:50:53,980 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:50:53,980 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-29 03:50:53,980 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:50:53,980 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-29 03:50:53,980 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:50:53,980 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-29 03:50:53,981 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:50:53,981 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-29 03:50:53,981 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:50:53,981 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("companies")
2025-09-29 03:50:53,981 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:50:53,981 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("setup_states")
2025-09-29 03:50:53,981 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 03:50:53,982 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-29 03:50:53,982 - __main__ - INFO - Database tables created successfully
2025-09-29 03:50:54,128 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-29 03:50:54,128 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-29 03:50:54,131 - app.services.scheduler_service - INFO - Scheduler started
2025-09-29 03:50:54,132 - app.services.scheduler_service - INFO - All background tasks started
2025-09-29 03:50:54,132 - __main__ - INFO - Application started with background tasks
2025-09-29 03:50:55,290 - app.services.scheduler_service - INFO - Scheduler stopped
2025-09-29 03:50:55,291 - app.services.scheduler_service - INFO - All background tasks stopped
2025-09-29 03:50:55,291 - __main__ - INFO - Application shutdown with background tasks stopped
2025-09-29 04:00:40,784 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-29 04:00:40,785 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("staff")
2025-09-29 04:00:40,785 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 04:00:40,786 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("attendance")
2025-09-29 04:00:40,786 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 04:00:40,787 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("sales")
2025-09-29 04:00:40,787 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 04:00:40,789 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("brands")
2025-09-29 04:00:40,789 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 04:00:40,789 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("targets")
2025-09-29 04:00:40,789 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 04:00:40,790 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("achievements")
2025-09-29 04:00:40,790 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 04:00:40,790 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("salary")
2025-09-29 04:00:40,790 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 04:00:40,790 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("advances")
2025-09-29 04:00:40,790 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 04:00:40,790 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("rankings")
2025-09-29 04:00:40,791 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 04:00:40,791 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("notifications")
2025-09-29 04:00:40,791 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 04:00:40,791 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("audit_logs")
2025-09-29 04:00:40,791 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 04:00:40,791 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("performance_metrics")
2025-09-29 04:00:40,791 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 04:00:40,791 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("companies")
2025-09-29 04:00:40,792 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 04:00:40,792 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("setup_states")
2025-09-29 04:00:40,792 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-29 04:00:40,792 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-29 04:00:40,793 - __main__ - INFO - Database tables created successfully
2025-09-29 04:00:41,061 - app.services.scheduler_service - INFO - Daily backup scheduled for 23:00
2025-09-29 04:00:41,061 - app.services.scheduler_service - INFO - Backup cleanup scheduled for 02:00
2025-09-29 04:00:41,065 - app.services.scheduler_service - INFO - Scheduler started
2025-09-29 04:00:41,065 - app.services.scheduler_service - INFO - All background tasks started
2025-09-29 04:00:41,065 - __main__ - INFO - Application started with background tasks
2025-09-29 04:00:41,489 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-29 04:00:41,490 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-29 04:00:41,490 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] ()
2025-09-29 04:00:41,568 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies
 LIMIT ? OFFSET ?
2025-09-29 04:00:41,568 - sqlalchemy.engine.Engine - INFO - [generated in 0.00057s] (1, 0)
2025-09-29 04:00:41,577 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.is_admin = 1
 LIMIT ? OFFSET ?
2025-09-29 04:00:41,577 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] (1, 0)
2025-09-29 04:00:41,584 - sqlalchemy.engine.Engine - INFO - SELECT setup_states.id AS setup_states_id, setup_states.company_created AS setup_states_company_created, setup_states.admin_created AS setup_states_admin_created, setup_states.database_initialized AS setup_states_database_initialized, setup_states.system_configured AS setup_states_system_configured, setup_states.setup_data AS setup_states_setup_data, setup_states.last_error AS setup_states_last_error, setup_states.error_count AS setup_states_error_count, setup_states.started_at AS setup_states_started_at, setup_states.completed_at AS setup_states_completed_at, setup_states.updated_at AS setup_states_updated_at 
FROM setup_states
 LIMIT ? OFFSET ?
2025-09-29 04:00:41,584 - sqlalchemy.engine.Engine - INFO - [generated in 0.00039s] (1, 0)
2025-09-29 04:00:41,586 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-29 04:00:47,233 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-29 04:00:47,233 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-29 04:00:47,233 - sqlalchemy.engine.Engine - INFO - [cached since 5.743s ago] ()
2025-09-29 04:00:47,234 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-29 04:00:54,134 - app.services.scheduler_service - INFO - Scheduler stopped
2025-09-29 04:00:54,135 - app.services.scheduler_service - INFO - All background tasks stopped
2025-09-29 04:00:54,135 - __main__ - INFO - Application shutdown with background tasks stopped
2025-09-29 04:00:55,843 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-29 04:00:55,844 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-29 04:00:55,844 - sqlalchemy.engine.Engine - INFO - [cached since 14.35s ago] ()
2025-09-29 04:00:55,846 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.name = ? AND staff.is_active = 1
 LIMIT ? OFFSET ?
2025-09-29 04:00:55,848 - sqlalchemy.engine.Engine - INFO - [generated in 0.00208s] ('Admin User', 1, 0)
2025-09-29 04:00:55,849 - app.models.base - ERROR - Unexpected database error: 401: Incorrect name or password
2025-09-29 04:00:55,849 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-29 04:00:58,284 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-29 04:00:58,284 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-29 04:00:58,284 - sqlalchemy.engine.Engine - INFO - [cached since 16.79s ago] ()
2025-09-29 04:00:58,285 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.name = ? AND staff.is_active = 1
 LIMIT ? OFFSET ?
2025-09-29 04:00:58,285 - sqlalchemy.engine.Engine - INFO - [cached since 2.44s ago] ('Admin User', 1, 0)
2025-09-29 04:00:58,286 - app.models.base - ERROR - Unexpected database error: 401: Incorrect name or password
2025-09-29 04:00:58,286 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-29 04:01:01,992 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-29 04:01:01,992 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-29 04:01:01,992 - sqlalchemy.engine.Engine - INFO - [cached since 20.5s ago] ()
2025-09-29 04:01:01,993 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies
 LIMIT ? OFFSET ?
2025-09-29 04:01:01,993 - sqlalchemy.engine.Engine - INFO - [cached since 20.43s ago] (1, 0)
2025-09-29 04:01:01,994 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.is_admin = 1
 LIMIT ? OFFSET ?
2025-09-29 04:01:01,994 - sqlalchemy.engine.Engine - INFO - [cached since 20.42s ago] (1, 0)
2025-09-29 04:01:01,995 - sqlalchemy.engine.Engine - INFO - SELECT setup_states.id AS setup_states_id, setup_states.company_created AS setup_states_company_created, setup_states.admin_created AS setup_states_admin_created, setup_states.database_initialized AS setup_states_database_initialized, setup_states.system_configured AS setup_states_system_configured, setup_states.setup_data AS setup_states_setup_data, setup_states.last_error AS setup_states_last_error, setup_states.error_count AS setup_states_error_count, setup_states.started_at AS setup_states_started_at, setup_states.completed_at AS setup_states_completed_at, setup_states.updated_at AS setup_states_updated_at 
FROM setup_states
 LIMIT ? OFFSET ?
2025-09-29 04:01:01,995 - sqlalchemy.engine.Engine - INFO - [cached since 20.41s ago] (1, 0)
2025-09-29 04:01:01,999 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-29 04:01:05,499 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-29 04:01:05,499 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-29 04:01:05,500 - sqlalchemy.engine.Engine - INFO - [cached since 24.01s ago] ()
2025-09-29 04:01:05,502 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies
 LIMIT ? OFFSET ?
2025-09-29 04:01:05,503 - sqlalchemy.engine.Engine - INFO - [cached since 23.93s ago] (1, 0)
2025-09-29 04:01:05,504 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.is_admin = 1
 LIMIT ? OFFSET ?
2025-09-29 04:01:05,504 - sqlalchemy.engine.Engine - INFO - [cached since 23.93s ago] (1, 0)
2025-09-29 04:01:05,504 - sqlalchemy.engine.Engine - INFO - SELECT setup_states.id AS setup_states_id, setup_states.company_created AS setup_states_company_created, setup_states.admin_created AS setup_states_admin_created, setup_states.database_initialized AS setup_states_database_initialized, setup_states.system_configured AS setup_states_system_configured, setup_states.setup_data AS setup_states_setup_data, setup_states.last_error AS setup_states_last_error, setup_states.error_count AS setup_states_error_count, setup_states.started_at AS setup_states_started_at, setup_states.completed_at AS setup_states_completed_at, setup_states.updated_at AS setup_states_updated_at 
FROM setup_states
 LIMIT ? OFFSET ?
2025-09-29 04:01:05,504 - sqlalchemy.engine.Engine - INFO - [cached since 23.92s ago] (1, 0)
2025-09-29 04:01:05,505 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-29 04:01:17,663 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-29 04:01:17,663 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-29 04:01:17,664 - sqlalchemy.engine.Engine - INFO - [cached since 36.17s ago] ()
2025-09-29 04:01:17,665 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.name = ? AND staff.is_active = 1
 LIMIT ? OFFSET ?
2025-09-29 04:01:17,665 - sqlalchemy.engine.Engine - INFO - [cached since 21.82s ago] ('Admin User', 1, 0)
2025-09-29 04:01:17,666 - app.models.base - ERROR - Unexpected database error: 401: Incorrect name or password
2025-09-29 04:01:17,666 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-29 04:01:19,825 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-29 04:01:19,825 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-29 04:01:19,825 - sqlalchemy.engine.Engine - INFO - [cached since 38.34s ago] ()
2025-09-29 04:01:19,829 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies
 LIMIT ? OFFSET ?
2025-09-29 04:01:19,829 - sqlalchemy.engine.Engine - INFO - [cached since 38.26s ago] (1, 0)
2025-09-29 04:01:19,830 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.is_admin = 1
 LIMIT ? OFFSET ?
2025-09-29 04:01:19,830 - sqlalchemy.engine.Engine - INFO - [cached since 38.25s ago] (1, 0)
2025-09-29 04:01:19,830 - sqlalchemy.engine.Engine - INFO - SELECT setup_states.id AS setup_states_id, setup_states.company_created AS setup_states_company_created, setup_states.admin_created AS setup_states_admin_created, setup_states.database_initialized AS setup_states_database_initialized, setup_states.system_configured AS setup_states_system_configured, setup_states.setup_data AS setup_states_setup_data, setup_states.last_error AS setup_states_last_error, setup_states.error_count AS setup_states_error_count, setup_states.started_at AS setup_states_started_at, setup_states.completed_at AS setup_states_completed_at, setup_states.updated_at AS setup_states_updated_at 
FROM setup_states
 LIMIT ? OFFSET ?
2025-09-29 04:01:19,830 - sqlalchemy.engine.Engine - INFO - [cached since 38.25s ago] (1, 0)
2025-09-29 04:01:19,831 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-29 04:04:19,505 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-29 04:04:19,505 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-29 04:04:19,505 - sqlalchemy.engine.Engine - INFO - [cached since 218s ago] ()
2025-09-29 04:04:19,507 - sqlalchemy.engine.Engine - INFO - SELECT companies.id AS companies_id, companies.name AS companies_name, companies.address AS companies_address, companies.phone AS companies_phone, companies.industry_type AS companies_industry_type, companies.timezone AS companies_timezone, companies.currency AS companies_currency, companies.working_hours_start AS companies_working_hours_start, companies.working_hours_end AS companies_working_hours_end, companies.is_setup_complete AS companies_is_setup_complete, companies.setup_completed_at AS companies_setup_completed_at, companies.created_at AS companies_created_at, companies.updated_at AS companies_updated_at 
FROM companies
 LIMIT ? OFFSET ?
2025-09-29 04:04:19,507 - sqlalchemy.engine.Engine - INFO - [cached since 217.9s ago] (1, 0)
2025-09-29 04:04:19,508 - sqlalchemy.engine.Engine - INFO - SELECT staff.id AS staff_id, staff.employee_code AS staff_employee_code, staff.name AS staff_name, staff.email AS staff_email, staff.password_hash AS staff_password_hash, staff.phone AS staff_phone, staff.basic_salary AS staff_basic_salary, staff.incentive_percentage AS staff_incentive_percentage, staff.department AS staff_department, staff.joining_date AS staff_joining_date, staff.is_active AS staff_is_active, staff.is_admin AS staff_is_admin, staff.created_at AS staff_created_at, staff.updated_at AS staff_updated_at 
FROM staff 
WHERE staff.is_admin = 1
 LIMIT ? OFFSET ?
2025-09-29 04:04:19,509 - sqlalchemy.engine.Engine - INFO - [cached since 217.9s ago] (1, 0)
2025-09-29 04:04:19,512 - sqlalchemy.engine.Engine - INFO - SELECT setup_states.id AS setup_states_id, setup_states.company_created AS setup_states_company_created, setup_states.admin_created AS setup_states_admin_created, setup_states.database_initialized AS setup_states_database_initialized, setup_states.system_configured AS setup_states_system_configured, setup_states.setup_data AS setup_states_setup_data, setup_states.last_error AS setup_states_last_error, setup_states.error_count AS setup_states_error_count, setup_states.started_at AS setup_states_started_at, setup_states.completed_at AS setup_states_completed_at, setup_states.updated_at AS setup_states_updated_at 
FROM setup_states
 LIMIT ? OFFSET ?
2025-09-29 04:04:19,513 - sqlalchemy.engine.Engine - INFO - [cached since 217.9s ago] (1, 0)
2025-09-29 04:04:19,514 - sqlalchemy.engine.Engine - INFO - ROLLBACK
